<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Example 2: Comparing two standard error estimators</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Example 2: Comparing two standard error estimators</h1>



<p>This vignette is adapted from <a href="https://avi-kenny.github.io/SimEngine/examples/2" target="_blank">Example 2</a> on the SimEngine website.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SimEngine)</span></code></pre></div>
<p>When developing a novel statistical method, we often wish to compare our proposed method with one or more existing methods. This serves to highlight the differences between our method and whatever is used in common practice. Generally, we wish to examine realistic settings, motivated by statistical theory, in which the novel method confers some advantage over the alternatives.</p>
<p>In this example, we will consider the problem of estimating the variance-covariance matrix of the least-squares estimator in linear regression. We assume the reader has some familiarity with linear regression.</p>
<p>Suppose our dataset consists of <span class="math inline">\(n\)</span> independent observations <span class="math inline">\(\{(Y_1, X_1), \dots, (Y_n, X_n)\}\)</span>, where <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are both scalar variables. A general linear regression model posits that</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + \epsilon_i\]</span></p>
<p>where <span class="math inline">\(\epsilon_i\)</span> is a mean-zero noise term with variance <span class="math inline">\(\sigma^2_i\)</span>. We refer to this as a heteroskedastic model, since the variances need not be equal across all <span class="math inline">\(i\)</span>. This is the true data-generating model. (Note: A more restrictive (but misspecified) model assumes that there is a common variance <span class="math inline">\(\sigma^2\)</span> such that <span class="math inline">\(\sigma^2_i = \sigma^2\)</span> for all <span class="math inline">\(i\)</span>. We refer to this incorrect model as the homoskedastic model.)</p>
<p>In linear regression, we use least-squares to estimate the coefficient vector <span class="math inline">\(\beta\)</span>. For the purposes of building confidence intervals and performing hypothesis tests, we need to also estimate the standard error of the least squares estimator. There are two common ways to do this: (1) Use a model-based standard error that assume homoskedasticity. This is the estimator used by default in most statistical software (including the <code>lm()</code> function in R). (2) Use a so-called sandwich standard error. Statistical theory tells us that estimator will be consistent even under heteroskedasticity. See the Statistical Appendix for more details.</p>
<p>We will carry out a small simulation study to compare these two estimators.</p>
<p>We start by declaring a new simulation object and writing a creator function that generates some data according to our model. For this simulation, we will make <span class="math inline">\(\sigma^2_i\)</span> larger for larger values of <span class="math inline">\(X_i\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">new_sim</span>()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">add_creator</span>(<span class="st">&quot;create_regression_data&quot;</span>, <span class="cf">function</span>(n) {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>n, <span class="at">mean=</span>(beta[<span class="dv">1</span>]<span class="sc">+</span>beta[<span class="dv">2</span>]<span class="sc">*</span>x), <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma2))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>To get a sense of what heteroskedasticity looks like in practice, we can generate a dataset using our creator function, fit a linear regression model, and make a scatterplot of the residuals against <span class="math inline">\(X\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> sim<span class="sc">$</span>creators<span class="sc">$</span><span class="fu">create_regression_data</span>(<span class="at">n=</span><span class="dv">500</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">data=</span>dat)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>residuals <span class="ot">&lt;-</span> linear_model<span class="sc">$</span>residuals</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>residuals)) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;x&quot;</span>, <span class="at">y=</span><span class="st">&quot;residual&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now we add two methods to our simulation object: one returns the least squares estimate and model-based estimator of the variance-covariance matrix of <span class="math inline">\(\hat{\beta}\)</span>, and the other returns the least squares estimate and sandwich estimator (using the sandwich package).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">add_method</span>(<span class="st">&quot;model_vcov&quot;</span>, <span class="cf">function</span>(data){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">data=</span>data)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">&quot;coef&quot;</span><span class="ot">=</span>mod<span class="sc">$</span>coefficients, <span class="st">&quot;vcov&quot;</span><span class="ot">=</span><span class="fu">diag</span>(<span class="fu">vcov</span>(mod))))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">add_method</span>(<span class="st">&quot;sandwich_vcov&quot;</span>, <span class="cf">function</span>(data){</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">data=</span>data)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">&quot;coef&quot;</span><span class="ot">=</span>mod<span class="sc">$</span>coefficients, <span class="st">&quot;vcov&quot;</span><span class="ot">=</span><span class="fu">diag</span>(<span class="fu">vcovHC</span>(mod))))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Next, we write the simulation script. This script returns a point estimate and a standard error estimate for both the intercept parameter <span class="math inline">\(\beta_0\)</span> and the slope parameter <span class="math inline">\(\beta_1\)</span>. We will tell SimEngine to run 500 simulation replicates for each of four sample sizes. It is important to use the <code>seed</code> argument in <code>set_config</code> so that our results will be reproducible. In addition, we will use the <code>packages</code> option to load the sandwich package. Loading packages via <code>set_config</code> (as opposed to running <code>library(sandwich)</code>) is required if running simulations in parallel. Finally, we run the simulation.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">set_script</span>(<span class="cf">function</span>() {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">create_regression_data</span>(<span class="at">n=</span>L<span class="sc">$</span>n)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  estimates <span class="ot">&lt;-</span> <span class="fu">use_method</span>(L<span class="sc">$</span>estimator, <span class="fu">list</span>(data))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;beta0_est&quot;</span> <span class="ot">=</span> estimates<span class="sc">$</span>coef[<span class="dv">1</span>],</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;beta1_est&quot;</span> <span class="ot">=</span> estimates<span class="sc">$</span>coef[<span class="dv">2</span>],</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;beta0_se_est&quot;</span> <span class="ot">=</span> <span class="fu">sqrt</span>(estimates<span class="sc">$</span>vcov[<span class="dv">1</span>]),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;beta1_se_est&quot;</span> <span class="ot">=</span> <span class="fu">sqrt</span>(estimates<span class="sc">$</span>vcov[<span class="dv">2</span>])</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">set_levels</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="fu">c</span>(<span class="st">&quot;model_vcov&quot;</span>, <span class="st">&quot;sandwich_vcov&quot;</span>),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">set_config</span>(</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_sim =</span> <span class="dv">500</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">24</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">packages =</span> <span class="fu">c</span>(<span class="st">&quot;sandwich&quot;</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">run</span>()</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Done. No errors or warnings detected.</span></span></code></pre></div>
<p>Now we can summarize the results using <code>summarize</code>. There are two main quantities of interest for us. The primary purpose of the standard error estimate for <span class="math inline">\(\hat{\beta}\)</span> is to form confidence intervals, so we will look at (1) the average width of the resulting interval (simply 1.96 times the average standard error estimate across simulation replicates), and (2) the estimated coverage of the interval, which is simply the proportion of simulation replicates in which the interval contains the true value of <span class="math inline">\(\beta\)</span>. We will focus on 95% confidence intervals in this simulation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>summarized_results <span class="ot">&lt;-</span> sim <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">list</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">name=</span><span class="st">&quot;mean_se_beta0&quot;</span>, <span class="at">x=</span><span class="st">&quot;beta0_se_est&quot;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">name=</span><span class="st">&quot;mean_se_beta1&quot;</span>, <span class="at">x=</span><span class="st">&quot;beta1_se_est&quot;</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">coverage =</span> <span class="fu">list</span>(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">name=</span><span class="st">&quot;cov_beta0&quot;</span>, <span class="at">estimate=</span><span class="st">&quot;beta0_est&quot;</span>, <span class="at">se=</span><span class="st">&quot;beta0_se_est&quot;</span>, <span class="at">truth=</span><span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">name=</span><span class="st">&quot;cov_beta1&quot;</span>, <span class="at">estimate=</span><span class="st">&quot;beta1_est&quot;</span>, <span class="at">se=</span><span class="st">&quot;beta1_se_est&quot;</span>, <span class="at">truth=</span><span class="dv">10</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summarized_results)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   level_id     estimator    n mean_se_beta0 mean_se_beta1 cov_beta0 cov_beta1</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        1    model_vcov   50    0.18110782    0.18232629     0.948     0.850</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        2 sandwich_vcov   50    0.18229941    0.24313215     0.938     0.922</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        3    model_vcov  100    0.12720997    0.12764561     0.946     0.864</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        4 sandwich_vcov  100    0.12800377    0.17264265     0.942     0.946</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        5    model_vcov  500    0.05703074    0.05697449     0.946     0.836</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        6 sandwich_vcov  500    0.05749570    0.07968853     0.948     0.942</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        7    model_vcov 1000    0.04055713    0.04058957     0.962     0.858</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8        8 sandwich_vcov 1000    0.04052118    0.05721305     0.958     0.958</span></span></code></pre></div>
<p>To visualize our results, we set up a plotting function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>plot_results <span class="ot">&lt;-</span> <span class="cf">function</span>(which_graph, n_est) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_est <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>, <span class="st">&quot;#56B4E9&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;model_vcov&quot;</span>, <span class="st">&quot;sandwich_vcov&quot;</span>, <span class="st">&quot;bootstrap_vcov&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Model-based&quot;</span>, <span class="st">&quot;Sandwich&quot;</span>, <span class="st">&quot;Bootstrap&quot;</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;model_vcov&quot;</span>, <span class="st">&quot;sandwich_vcov&quot;</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Model-based&quot;</span>, <span class="st">&quot;Sandwich&quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (which_graph <span class="sc">==</span> <span class="st">&quot;width&quot;</span>) {</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    summarized_results <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;mean_se_beta0&quot;</span>, <span class="st">&quot;mean_se_beta1&quot;</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">&quot;parameter&quot;</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_prefix =</span> <span class="st">&quot;mean_se_&quot;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span><span class="fl">1.96</span><span class="sc">*</span>value, <span class="at">color=</span>estimator)) <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>parameter)) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Average CI width&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> values,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> breaks,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">&quot;SE estimator&quot;</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> labels</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_discrete</span>(</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;beta0&quot;</span>, <span class="st">&quot;beta1&quot;</span>),</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">&quot;Parameter&quot;</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(beta[<span class="dv">0</span>]), <span class="fu">expression</span>(beta[<span class="dv">1</span>]))</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    summarized_results <span class="sc">%&gt;%</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;cov_beta0&quot;</span>,<span class="st">&quot;cov_beta1&quot;</span>),</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">&quot;parameter&quot;</span>,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_prefix =</span> <span class="st">&quot;cov_&quot;</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>value, <span class="at">color=</span>estimator)) <span class="sc">+</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> parameter)) <span class="sc">+</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Coverage&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> values,</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> breaks,</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">&quot;SE estimator&quot;</span>,</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> labels</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_discrete</span>(</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;beta0&quot;</span>, <span class="st">&quot;beta1&quot;</span>),</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">&quot;Parameter&quot;</span>,</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(beta[<span class="dv">0</span>]), <span class="fu">expression</span>(beta[<span class="dv">1</span>]))</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.95</span>)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We then use the plotting function to make our figures.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_results</span>(<span class="st">&quot;width&quot;</span>, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_results</span>(<span class="st">&quot;coverage&quot;</span>, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Looking at these plots, we can see that the sandwich method results in a wider interval, on average, for <span class="math inline">\(\beta_1\)</span>. In terms of coverage, the sandwich estimator achieves near nominal coverage for both parameters, while there is moderate undercoverage for <span class="math inline">\(\beta_1\)</span> using the model-based estimator.</p>
<p>The bootstrap is another popular approach to estimating standard errors. We can add a bootstrap method to our simulation object and use <code>update_sim</code> to run the new simulation replicates without re-running any of our previous work. After adding the method using <code>add_method</code>, we will need to include the new estimator in our simulation levels. Since the bootstrap can be computationally intensive, we will use parallelization to speed things up. This requires us to specify the option <code>parallel = &quot;outer&quot;</code> in <code>set_config</code>. (Even with parallelization, <code>update_sim</code> will likely take a few minutes to run.)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">add_method</span>(<span class="st">&quot;bootstrap_vcov&quot;</span>, <span class="cf">function</span>(data) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">data=</span>data)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  boot_ests <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span><span class="dv">100</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="at">size=</span><span class="fu">nrow</span>(data), <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    boot_dat <span class="ot">&lt;-</span> data[indices,]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    boot_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">data=</span>boot_dat)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    boot_ests[j,] <span class="ot">&lt;-</span> boot_mod<span class="sc">$</span>coefficients</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  boot_v1 <span class="ot">&lt;-</span> <span class="fu">var</span>(boot_ests[,<span class="dv">1</span>])</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  boot_v2 <span class="ot">&lt;-</span> <span class="fu">var</span>(boot_ests[,<span class="dv">2</span>])</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">&quot;coef&quot;</span><span class="ot">=</span>mod<span class="sc">$</span>coefficients, <span class="st">&quot;vcov&quot;</span><span class="ot">=</span><span class="fu">c</span>(boot_v1, boot_v2)))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">set_levels</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="fu">c</span>(<span class="st">&quot;model_vcov&quot;</span>, <span class="st">&quot;sandwich_vcov&quot;</span>, <span class="st">&quot;bootstrap_vcov&quot;</span>),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">set_config</span>(</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_sim=</span><span class="dv">500</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">24</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel =</span> <span class="st">&quot;outer&quot;</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_cores =</span> <span class="dv">2</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">packages =</span> <span class="fu">c</span>(<span class="st">&quot;sandwich&quot;</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">%&lt;&gt;%</span> <span class="fu">update_sim</span>()</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Done. No errors or warnings detected.</span></span></code></pre></div>
<p>Now that we have the bootstrap results included in our simulation object, we can look at the updated results.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>summarized_results <span class="ot">&lt;-</span> sim <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">list</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">name=</span><span class="st">&quot;mean_se_beta0&quot;</span>, <span class="at">x=</span><span class="st">&quot;beta0_se_est&quot;</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">name=</span><span class="st">&quot;mean_se_beta1&quot;</span>, <span class="at">x=</span><span class="st">&quot;beta1_se_est&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">coverage =</span> <span class="fu">list</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">name=</span><span class="st">&quot;cov_beta0&quot;</span>, <span class="at">estimate=</span><span class="st">&quot;beta0_est&quot;</span>, <span class="at">se=</span><span class="st">&quot;beta0_se_est&quot;</span>, <span class="at">truth=</span><span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">name=</span><span class="st">&quot;cov_beta1&quot;</span>, <span class="at">estimate=</span><span class="st">&quot;beta1_est&quot;</span>, <span class="at">se=</span><span class="st">&quot;beta1_se_est&quot;</span>, <span class="at">truth=</span><span class="dv">10</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_results</span>(<span class="st">&quot;width&quot;</span>, <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_results</span>(<span class="st">&quot;coverage&quot;</span>, <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Like the sandwich estimator, the bootstrap results in wider intervals for <span class="math inline">\(\beta_1\)</span>, but is much closer to achieving 95% coverage compared to the model-based estimator.</p>
<hr />
<div id="statistical-appendix" class="section level1">
<h1>Statistical appendix</h1>
<p>For notational simplicity, we build a matrix <span class="math inline">\(\mathbb{X}\)</span>, whose first column is all 1s (the intercept column) and whose second column is <span class="math inline">\((X_1, \dots, X_n)^T\)</span>. We also define a matrix</p>
<p><span class="math display">\[ \Sigma = \begin{pmatrix}\sigma^2_1 &amp;\dots&amp; 0 \\ \vdots &amp;\ddots&amp; \vdots \\ 0 &amp; \dots &amp; \sigma^2_n\end{pmatrix}\]</span></p>
<p>The ordinary least squares estimator of <span class="math inline">\(\beta\)</span> is <span class="math inline">\(\hat{\beta} = (\mathbb{X}^T\mathbb{X})^{-1}\mathbb{X}^T\mathbb{Y}\)</span>. The variance of this estimator, which we call <span class="math inline">\(\mathbb{V}\)</span> is</p>
<p><span class="math display">\[\text{Var}(\hat{\beta}) = (\mathbb{X}^T\mathbb{X})^{-1}\mathbb{X}^T\Sigma\mathbb{X}(\mathbb{X}^T\mathbb{X})^{-1}\]</span></p>
<p>The usual estimator of <span class="math inline">\(\mathbb{V}\)</span> is the model-based standard error <span class="math inline">\(s^2(\mathbb{X}^T\mathbb{X})^{-1}\)</span>, where <span class="math inline">\(s^2 = \frac{\sum_i (Y_i - (\hat{\beta}_0 + \hat{\beta}_1X_i))^2}{n-1}\)</span>. However, under our heteroskedastic model where the <span class="math inline">\(\sigma^2_i\)</span> are not all equal, this is not a consistent estimator of <span class="math inline">\(\mathbb{V}\)</span>! That is to say, even in large samples, we cannot generally expect this estimator to be close to the truth.</p>
<p>A better estimator for our setting is the sandwich standard error, or Huber-White standard error, given by</p>
<p><span class="math display">\[(\mathbb{X}^T\mathbb{X})^{-1}\mathbb{X}^T\hat{\Sigma}\mathbb{X}(\mathbb{X}^T\mathbb{X})^{-1}\]</span></p>
<p>where</p>
<p><span class="math display">\[\hat{\Sigma} = \begin{pmatrix}(Y_1 - (\hat{\beta}_0 + \hat{\beta}_1X_1))^2  &amp;\dots&amp; 0 \\ \vdots &amp;\ddots&amp; \vdots \\ 0 &amp; \dots &amp; (Y_n - (\hat{\beta}_0 + \hat{\beta}_1X_n))^2\end{pmatrix}\]</span></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
